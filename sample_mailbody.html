<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Demo for Verse Extension</title>

  <style type="text/css">
    body {   font-family: "Open Sans", sans-serif; }
  </style>
    

</head>

<body>

  <h1>Demo for Verse Extension</h1>

  <p>Subject: <span id="subject"></span></span></p>
  <p>MailBody: <span id="mailBody"></span></p>
  
  
  
  
  <script>
    var opener = window.opener;
    if (opener) {
      var message = {
        verseApiType : "com.ibm.verse.application.loaded",
      };
      opener.postMessage(message, '*');
      console.log("========================opener", opener);

      window.addEventListener("message", function(event) {
        var eventData =event.data;
        console.log("========================eventData", eventData);
        if (eventData.verseApiType === "com.ibm.verse.action.clicked") {
		      var actionData = eventData.verseApiData;
          console.log("========================actionData.actionId", actionData.actionId);
          if (actionData.actionId === "com.ibm.verse.ext.mail.crossWindow_jun1") {
            var message = actionData.context;
            if (message && message.subject) {
              document.getElementById("subject").innerHTML = message.subject;
            }
            if (message && message.body) {
              document.getElementById("mailBody").innerHTML = message.body;
            }
          }
        } else if (eventData.verseApiType === "com.ibm.verse.application.loaded") {
          var message = {
            verseApiType : "com.ibm.verse.application.loaded",
          };
          opener.postMessage(message, '*');
          console.log("========================opener", opener);
        }
      }, false);
    }
  </script>
</body>
</html>